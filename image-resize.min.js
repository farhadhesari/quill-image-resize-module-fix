!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ImageResize=e():t.ImageResize=e()}(self,(()=>(()=>{var t={1549:(t,e,r)=>{var o=r(2032),n=r(3862),i=r(6721),s=r(2749),a=r(5749);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=n,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,t.exports=l},79:(t,e,r)=>{var o=r(3702),n=r(80),i=r(4739),s=r(8655),a=r(1175);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=n,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,t.exports=l},8223:(t,e,r)=>{var o=r(6110)(r(9325),"Map");t.exports=o},3661:(t,e,r)=>{var o=r(3040),n=r(7670),i=r(289),s=r(4509),a=r(2949);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=n,l.prototype.get=i,l.prototype.has=s,l.prototype.set=a,t.exports=l},7217:(t,e,r)=>{var o=r(79),n=r(1420),i=r(938),s=r(3605),a=r(9817),l=r(945);function c(t){var e=this.__data__=new o(t);this.size=e.size}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=a,c.prototype.set=l,t.exports=c},1873:(t,e,r)=>{var o=r(9325).Symbol;t.exports=o},7828:(t,e,r)=>{var o=r(9325).Uint8Array;t.exports=o},1033:t=>{t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},695:(t,e,r)=>{var o=r(8096),n=r(2428),i=r(6449),s=r(3656),a=r(361),l=r(7167),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=i(t),u=!r&&n(t),h=!r&&!u&&s(t),d=!r&&!u&&!h&&l(t),p=r||u||h||d,f=p?o(t.length,String):[],m=f.length;for(var y in t)!e&&!c.call(t,y)||p&&("length"==y||h&&("offset"==y||"parent"==y)||d&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||a(y,m))||f.push(y);return f}},7805:(t,e,r)=>{var o=r(3360),n=r(5288);t.exports=function(t,e,r){(void 0!==r&&!n(t[e],r)||void 0===r&&!(e in t))&&o(t,e,r)}},6547:(t,e,r)=>{var o=r(3360),n=r(5288),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){var s=t[e];i.call(t,e)&&n(s,r)&&(void 0!==r||e in t)||o(t,e,r)}},6025:(t,e,r)=>{var o=r(5288);t.exports=function(t,e){for(var r=t.length;r--;)if(o(t[r][0],e))return r;return-1}},3360:(t,e,r)=>{var o=r(3243);t.exports=function(t,e,r){"__proto__"==e&&o?o(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},9344:(t,e,r)=>{var o=r(3805),n=Object.create,i=function(){function t(){}return function(e){if(!o(e))return{};if(n)return n(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();t.exports=i},6649:(t,e,r)=>{var o=r(3221)();t.exports=o},2552:(t,e,r)=>{var o=r(1873),n=r(659),i=r(9350),s=o?o.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?n(t):i(t)}},7534:(t,e,r)=>{var o=r(2552),n=r(346);t.exports=function(t){return n(t)&&"[object Arguments]"==o(t)}},5083:(t,e,r)=>{var o=r(1882),n=r(7296),i=r(3805),s=r(7473),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,h=c.hasOwnProperty,d=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||n(t))&&(o(t)?d:a).test(s(t))}},4901:(t,e,r)=>{var o=r(2552),n=r(294),i=r(346),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&n(t.length)&&!!s[o(t)]}},2903:(t,e,r)=>{var o=r(3805),n=r(5527),i=r(181),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!o(t))return i(t);var e=n(t),r=[];for(var a in t)("constructor"!=a||!e&&s.call(t,a))&&r.push(a);return r}},5250:(t,e,r)=>{var o=r(7217),n=r(7805),i=r(6649),s=r(2824),a=r(3805),l=r(7241),c=r(4974);t.exports=function t(e,r,u,h,d){e!==r&&i(r,(function(i,l){if(d||(d=new o),a(i))s(e,r,l,u,t,h,d);else{var p=h?h(c(e,l),i,l+"",e,r,d):void 0;void 0===p&&(p=i),n(e,l,p)}}),l)}},2824:(t,e,r)=>{var o=r(7805),n=r(3290),i=r(1961),s=r(3007),a=r(5529),l=r(2428),c=r(6449),u=r(3693),h=r(3656),d=r(1882),p=r(3805),f=r(1331),m=r(7167),y=r(4974),v=r(9884);t.exports=function(t,e,r,b,g,x,N){var w=y(t,r),_=y(e,r),O=N.get(_);if(O)o(t,r,O);else{var j=x?x(w,_,r+"",t,e,N):void 0,A=void 0===j;if(A){var E=c(_),T=!E&&h(_),C=!E&&!T&&m(_);j=_,E||T||C?c(w)?j=w:u(w)?j=s(w):T?(A=!1,j=n(_,!0)):C?(A=!1,j=i(_,!0)):j=[]:f(_)||l(_)?(j=w,l(w)?j=v(w):p(w)&&!d(w)||(j=a(_))):A=!1}A&&(N.set(_,j),g(j,_,b,x,N),N.delete(_)),o(t,r,j)}}},9302:(t,e,r)=>{var o=r(3488),n=r(6757),i=r(2865);t.exports=function(t,e){return i(n(t,e,o),t+"")}},9570:(t,e,r)=>{var o=r(7334),n=r(3243),i=r(3488),s=n?function(t,e){return n(t,"toString",{configurable:!0,enumerable:!1,value:o(e),writable:!0})}:i;t.exports=s},8096:t=>{t.exports=function(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}},7301:t=>{t.exports=function(t){return function(e){return t(e)}}},9653:(t,e,r)=>{var o=r(7828);t.exports=function(t){var e=new t.constructor(t.byteLength);return new o(e).set(new o(t)),e}},3290:(t,e,r)=>{t=r.nmd(t);var o=r(9325),n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,s=i&&i.exports===n?o.Buffer:void 0,a=s?s.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,o=a?a(r):new t.constructor(r);return t.copy(o),o}},1961:(t,e,r)=>{var o=r(9653);t.exports=function(t,e){var r=e?o(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}},3007:t=>{t.exports=function(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}},1791:(t,e,r)=>{var o=r(6547),n=r(3360);t.exports=function(t,e,r,i){var s=!r;r||(r={});for(var a=-1,l=e.length;++a<l;){var c=e[a],u=i?i(r[c],t[c],c,r,t):void 0;void 0===u&&(u=t[c]),s?n(r,c,u):o(r,c,u)}return r}},5481:(t,e,r)=>{var o=r(9325)["__core-js_shared__"];t.exports=o},999:(t,e,r)=>{var o=r(9302),n=r(6800);t.exports=function(t){return o((function(e,r){var o=-1,i=r.length,s=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(s=t.length>3&&"function"==typeof s?(i--,s):void 0,a&&n(r[0],r[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++o<i;){var l=r[o];l&&t(e,l,o,s)}return e}))}},3221:t=>{t.exports=function(t){return function(e,r,o){for(var n=-1,i=Object(e),s=o(e),a=s.length;a--;){var l=s[t?a:++n];if(!1===r(i[l],l,i))break}return e}}},2606:(t,e,r)=>{var o=r(5250),n=r(3805);t.exports=function t(e,r,i,s,a,l){return n(e)&&n(r)&&(l.set(r,e),o(e,r,void 0,t,l),l.delete(r)),e}},3243:(t,e,r)=>{var o=r(6110),n=function(){try{var t=o(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},4840:(t,e,r)=>{var o="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=o},2651:(t,e,r)=>{var o=r(4218);t.exports=function(t,e){var r=t.__data__;return o(e)?r["string"==typeof e?"string":"hash"]:r.map}},6110:(t,e,r)=>{var o=r(5083),n=r(392);t.exports=function(t,e){var r=n(t,e);return o(r)?r:void 0}},8879:(t,e,r)=>{var o=r(4335)(Object.getPrototypeOf,Object);t.exports=o},659:(t,e,r)=>{var o=r(1873),n=Object.prototype,i=n.hasOwnProperty,s=n.toString,a=o?o.toStringTag:void 0;t.exports=function(t){var e=i.call(t,a),r=t[a];try{t[a]=void 0;var o=!0}catch(t){}var n=s.call(t);return o&&(e?t[a]=r:delete t[a]),n}},392:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},2032:(t,e,r)=>{var o=r(1042);t.exports=function(){this.__data__=o?o(null):{},this.size=0}},3862:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},6721:(t,e,r)=>{var o=r(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(o){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return n.call(e,t)?e[t]:void 0}},2749:(t,e,r)=>{var o=r(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return o?void 0!==e[t]:n.call(e,t)}},5749:(t,e,r)=>{var o=r(1042);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=o&&void 0===e?"__lodash_hash_undefined__":e,this}},5529:(t,e,r)=>{var o=r(9344),n=r(8879),i=r(5527);t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:o(n(t))}},361:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var o=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==o||"symbol"!=o&&e.test(t))&&t>-1&&t%1==0&&t<r}},6800:(t,e,r)=>{var o=r(5288),n=r(4894),i=r(361),s=r(3805);t.exports=function(t,e,r){if(!s(r))return!1;var a=typeof e;return!!("number"==a?n(r)&&i(e,r.length):"string"==a&&e in r)&&o(r[e],t)}},4218:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},7296:(t,e,r)=>{var o,n=r(5481),i=(o=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"";t.exports=function(t){return!!i&&i in t}},5527:t=>{var e=Object.prototype;t.exports=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},3702:t=>{t.exports=function(){this.__data__=[],this.size=0}},80:(t,e,r)=>{var o=r(6025),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=o(e,t);return!(r<0||(r==e.length-1?e.pop():n.call(e,r,1),--this.size,0))}},4739:(t,e,r)=>{var o=r(6025);t.exports=function(t){var e=this.__data__,r=o(e,t);return r<0?void 0:e[r][1]}},8655:(t,e,r)=>{var o=r(6025);t.exports=function(t){return o(this.__data__,t)>-1}},1175:(t,e,r)=>{var o=r(6025);t.exports=function(t,e){var r=this.__data__,n=o(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}},3040:(t,e,r)=>{var o=r(1549),n=r(79),i=r(8223);t.exports=function(){this.size=0,this.__data__={hash:new o,map:new(i||n),string:new o}}},7670:(t,e,r)=>{var o=r(2651);t.exports=function(t){var e=o(this,t).delete(t);return this.size-=e?1:0,e}},289:(t,e,r)=>{var o=r(2651);t.exports=function(t){return o(this,t).get(t)}},4509:(t,e,r)=>{var o=r(2651);t.exports=function(t){return o(this,t).has(t)}},2949:(t,e,r)=>{var o=r(2651);t.exports=function(t,e){var r=o(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}},1042:(t,e,r)=>{var o=r(6110)(Object,"create");t.exports=o},181:t=>{t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},6009:(t,e,r)=>{t=r.nmd(t);var o=r(4840),n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,s=i&&i.exports===n&&o.process,a=function(){try{return i&&i.require&&i.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},9350:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},4335:t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},6757:(t,e,r)=>{var o=r(1033),n=Math.max;t.exports=function(t,e,r){return e=n(void 0===e?t.length-1:e,0),function(){for(var i=arguments,s=-1,a=n(i.length-e,0),l=Array(a);++s<a;)l[s]=i[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=i[s];return c[e]=r(l),o(t,this,c)}}},9325:(t,e,r)=>{var o=r(4840),n="object"==typeof self&&self&&self.Object===Object&&self,i=o||n||Function("return this")();t.exports=i},4974:t=>{t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},2865:(t,e,r)=>{var o=r(9570),n=r(1811)(o);t.exports=n},1811:t=>{var e=Date.now;t.exports=function(t){var r=0,o=0;return function(){var n=e(),i=16-(n-o);if(o=n,i>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}},1420:(t,e,r)=>{var o=r(79);t.exports=function(){this.__data__=new o,this.size=0}},938:t=>{t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},3605:t=>{t.exports=function(t){return this.__data__.get(t)}},9817:t=>{t.exports=function(t){return this.__data__.has(t)}},945:(t,e,r)=>{var o=r(79),n=r(8223),i=r(3661);t.exports=function(t,e){var r=this.__data__;if(r instanceof o){var s=r.__data__;if(!n||s.length<199)return s.push([t,e]),this.size=++r.size,this;r=this.__data__=new i(s)}return r.set(t,e),this.size=r.size,this}},7473:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},7334:t=>{t.exports=function(t){return function(){return t}}},4354:(t,e,r)=>{var o=r(1033),n=r(9302),i=r(2606),s=r(6924),a=n((function(t){return t.push(void 0,i),o(s,void 0,t)}));t.exports=a},5288:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},3488:t=>{t.exports=function(t){return t}},2428:(t,e,r)=>{var o=r(7534),n=r(346),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(t){return n(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=l},6449:t=>{var e=Array.isArray;t.exports=e},4894:(t,e,r)=>{var o=r(1882),n=r(294);t.exports=function(t){return null!=t&&n(t.length)&&!o(t)}},3693:(t,e,r)=>{var o=r(4894),n=r(346);t.exports=function(t){return n(t)&&o(t)}},3656:(t,e,r)=>{t=r.nmd(t);var o=r(9325),n=r(9935),i=e&&!e.nodeType&&e,s=i&&t&&!t.nodeType&&t,a=s&&s.exports===i?o.Buffer:void 0,l=(a?a.isBuffer:void 0)||n;t.exports=l},1882:(t,e,r)=>{var o=r(2552),n=r(3805);t.exports=function(t){if(!n(t))return!1;var e=o(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},294:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3805:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},346:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},1331:(t,e,r)=>{var o=r(2552),n=r(8879),i=r(346),s=Function.prototype,a=Object.prototype,l=s.toString,c=a.hasOwnProperty,u=l.call(Object);t.exports=function(t){if(!i(t)||"[object Object]"!=o(t))return!1;var e=n(t);if(null===e)return!0;var r=c.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==u}},7167:(t,e,r)=>{var o=r(4901),n=r(7301),i=r(6009),s=i&&i.isTypedArray,a=s?n(s):o;t.exports=a},7241:(t,e,r)=>{var o=r(695),n=r(2903),i=r(4894);t.exports=function(t){return i(t)?o(t,!0):n(t)}},6924:(t,e,r)=>{var o=r(5250),n=r(999)((function(t,e,r,n){o(t,e,r,n)}));t.exports=n},9935:t=>{t.exports=function(){return!1}},9884:(t,e,r)=>{var o=r(1791),n=r(7241);t.exports=function(t){return o(t,n(t))}}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={id:o,loaded:!1,exports:{}};return t[o](i,i.exports,r),i.loaded=!0,i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var o={};return(()=>{"use strict";r.r(o),r.d(o,{default:()=>dt});var t=r(4354),e=r.n(t);const n={modules:["DisplaySize","Toolbar","Resize"],overlayStyles:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"},handleStyles:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},displayStyles:{position:"absolute",font:"12px/1.0 Arial, Helvetica, sans-serif",padding:"4px 8px",textAlign:"center",backgroundColor:"white",color:"#333",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80",cursor:"default"},toolbarStyles:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default"},toolbarButtonStyles:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},toolbarButtonSvgStyles:{fill:"#444",stroke:"#444",strokeWidth:"2"}};function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,c(o.key),o)}}function a(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var u=a((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,"onCreate",(function(){})),l(this,"onDestroy",(function(){})),l(this,"onUpdate",(function(){})),this.overlay=e.overlay,this.img=e.img,this.options=e.options,this.requestUpdate=e.onUpdate}));function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function m(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){var e=function(t){if("object"!=h(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:e+""}var v=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return m(t=function(t,e,r){return e=p(e),function(t,e){if(e&&("object"==h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}(this,e,[].concat(o)),"onCreate",(function(){t.display=document.createElement("div"),Object.assign(t.display.style,t.options.displayStyles),t.overlay.appendChild(t.display)})),m(t,"onDestroy",(function(){})),m(t,"onUpdate",(function(){if(t.display&&t.img){var e=t.getCurrentSize();if(t.display.innerHTML=e.join(" &times; "),e[0]>120&&e[1]>30)Object.assign(t.display.style,{right:"4px",bottom:"4px",left:"auto"});else if("right"==t.img.style.float){var r=t.display.getBoundingClientRect();Object.assign(t.display.style,{right:"auto",bottom:"-".concat(r.height+4,"px"),left:"-".concat(r.width+4,"px")})}else{var o=t.display.getBoundingClientRect();Object.assign(t.display.style,{right:"-".concat(o.width+4,"px"),bottom:"-".concat(o.height+4,"px"),left:"auto"})}}})),m(t,"getCurrentSize",(function(){return[t.img.width,Math.round(t.img.width/t.img.naturalWidth*t.img.naturalHeight)]})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(u),b=(t=>(t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY",t))(b||{});class g{constructor(t,e,r={}){this.attrName=t,this.keyName=e;const o=b.TYPE&b.ATTRIBUTE;this.scope=null!=r.scope?r.scope&b.LEVEL|o:b.ATTRIBUTE,null!=r.whitelist&&(this.whitelist=r.whitelist)}static keys(t){return Array.from(t.attributes).map((t=>t.name))}add(t,e){return!!this.canAdd(t,e)&&(t.setAttribute(this.keyName,e),!0)}canAdd(t,e){return null==this.whitelist||("string"==typeof e?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1)}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class x extends Error{constructor(t){super(t="[Parchment] "+t),this.message=t,this.name=this.constructor.name}}const N=class t{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(null==t)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let r=null;try{r=t.parentNode}catch{return null}return this.find(r,e)}return null}create(e,r,o){const n=this.query(r);if(null==n)throw new x(`Unable to create ${r} blot`);const i=n,s=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:i.create(o),a=new i(e,s,o);return t.blots.set(a.domNode,a),a}find(e,r=!1){return t.find(e,r)}query(t,e=b.ANY){let r;return"string"==typeof t?r=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?r=this.types.text:"number"==typeof t?t&b.LEVEL&b.BLOCK?r=this.types.block:t&b.LEVEL&b.INLINE&&(r=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some((t=>(r=this.classes[t],!!r))),r=r||this.tags[t.tagName]),null==r?null:"scope"in r&&e&b.LEVEL&r.scope&&e&b.TYPE&r.scope?r:null}register(...t){return t.map((t=>{const e="blotName"in t,r="attrName"in t;if(!e&&!r)throw new x("Invalid definition");if(e&&"abstract"===t.blotName)throw new x("Cannot register abstract class");const o=e?t.blotName:r?t.attrName:void 0;return this.types[o]=t,r?"string"==typeof t.keyName&&(this.attributes[t.keyName]=t):e&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map((t=>t.toUpperCase())):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach((e=>{(null==this.tags[e]||null==t.className)&&(this.tags[e]=t)})))),t}))}};N.blots=new WeakMap;let w=N;function _(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter((t=>0===t.indexOf(`${e}-`)))}const O=class extends g{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map((t=>t.split("-").slice(0,-1).join("-")))}add(t,e){return!!this.canAdd(t,e)&&(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0)}remove(t){_(t,this.keyName).forEach((e=>{t.classList.remove(e)})),0===t.classList.length&&t.removeAttribute("class")}value(t){const e=(_(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}};function j(t){const e=t.split("-"),r=e.slice(1).map((t=>t[0].toUpperCase()+t.slice(1))).join("");return e[0]+r}const A=class extends g{static keys(t){return(t.getAttribute("style")||"").split(";").map((t=>t.split(":")[0].trim()))}add(t,e){return!!this.canAdd(t,e)&&(t.style[j(this.keyName)]=e,!0)}remove(t){t.style[j(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[j(this.keyName)];return this.canAdd(t,e)?e:""}},E=class{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(null!=t.value(this.domNode)?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=w.find(this.domNode);if(null==t)return;const e=g.keys(this.domNode),r=O.keys(this.domNode),o=A.keys(this.domNode);e.concat(r).concat(o).forEach((e=>{const r=t.scroll.query(e,b.ATTRIBUTE);r instanceof g&&(this.attributes[r.attrName]=r)}))}copy(t){Object.keys(this.attributes).forEach((e=>{const r=this.attributes[e].value(this.domNode);t.format(e,r)}))}move(t){this.copy(t),Object.keys(this.attributes).forEach((t=>{this.attributes[t].remove(this.domNode)})),this.attributes={}}values(){return Object.keys(this.attributes).reduce(((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t)),{})}},T=class{constructor(t,e){this.scroll=t,this.domNode=e,w.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(null==this.tagName)throw new x("Blot definition missing tagName");let e,r;return Array.isArray(this.tagName)?("string"==typeof t?(r=t.toUpperCase(),parseInt(r,10).toString()===r&&(r=parseInt(r,10))):"number"==typeof t&&(r=t),e="number"==typeof r?document.createElement(this.tagName[r-1]):r&&this.tagName.indexOf(r)>-1?document.createElement(r):document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){null!=this.parent&&this.parent.removeChild(this),w.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,r,o){const n=this.isolate(t,e);if(null!=this.scroll.query(r,b.BLOT)&&o)n.wrap(r,o);else if(null!=this.scroll.query(r,b.ATTRIBUTE)){const t=this.scroll.create(this.statics.scope);n.wrap(t),t.format(r,o)}}insertAt(t,e,r){const o=null==r?this.scroll.create("text",e):this.scroll.create(e,r),n=this.split(t);this.parent.insertBefore(o,n||void 0)}isolate(t,e){const r=this.split(t);if(null==r)throw new Error("Attempt to isolate at end");return r.split(e),r}length(){return 1}offset(t=this.parent){return null==this.parent||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const r="string"==typeof t?this.scroll.create(t,e):t;return null!=this.parent&&(this.parent.insertBefore(r,this.next||void 0),this.remove()),r}split(t,e){return 0===t?this:this.next}update(t,e){}wrap(t,e){const r="string"==typeof t?this.scroll.create(t,e):t;if(null!=this.parent&&this.parent.insertBefore(r,this.next||void 0),"function"!=typeof r.appendChild)throw new x(`Cannot wrap ${t}`);return r.appendChild(this),r}};T.blotName="abstract";let C=T;const S=class extends C{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let r=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(r+=1),[this.parent.domNode,r]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};S.scope=b.INLINE_BLOT;const B=S;class L{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let r=e();for(;r&&t>0;)t-=1,r=e();return r}contains(t){const e=this.iterator();let r=e();for(;r;){if(r===t)return!0;r=e()}return!1}indexOf(t){const e=this.iterator();let r=e(),o=0;for(;r;){if(r===t)return o;o+=1,r=e()}return-1}insertBefore(t,e){null!=t&&(this.remove(t),t.next=e,null!=e?(t.prev=e.prev,null!=e.prev&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):null!=this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,r=this.head;for(;null!=r;){if(r===t)return e;e+=r.length(),r=r.next}return-1}remove(t){this.contains(t)&&(null!=t.prev&&(t.prev.next=t.next),null!=t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return null!=t&&(t=t.next),e}}find(t,e=!1){const r=this.iterator();let o=r();for(;o;){const n=o.length();if(t<n||e&&t===n&&(null==o.next||0!==o.next.length()))return[o,t];t-=n,o=r()}return[null,0]}forEach(t){const e=this.iterator();let r=e();for(;r;)t(r),r=e()}forEachAt(t,e,r){if(e<=0)return;const[o,n]=this.find(t);let i=t-n;const s=this.iterator(o);let a=s();for(;a&&i<t+e;){const o=a.length();t>i?r(a,t-i,Math.min(e,i+o-t)):r(a,0,Math.min(o,t+e-i)),i+=o,a=s()}}map(t){return this.reduce(((e,r)=>(e.push(t(r)),e)),[])}reduce(t,e){const r=this.iterator();let o=r();for(;o;)e=t(e,o),o=r();return e}}function k(t,e){const r=e.find(t);if(r)return r;try{return e.create(t)}catch{const r=e.create(b.INLINE);return Array.from(t.childNodes).forEach((t=>{r.domNode.appendChild(t)})),t.parentNode&&t.parentNode.replaceChild(r.domNode,t),r.attach(),r}}const P=class t extends C{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach((t=>{t.attach()}))}attachUI(e){null!=this.uiNode&&this.uiNode.remove(),this.uiNode=e,t.uiClass&&this.uiNode.classList.add(t.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new L,Array.from(this.domNode.childNodes).filter((t=>t!==this.uiNode)).reverse().forEach((t=>{try{const e=k(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(t){if(t instanceof x)return;throw t}}))}deleteAt(t,e){if(0===t&&e===this.length())return this.remove();this.children.forEachAt(t,e,((t,e,r)=>{t.deleteAt(e,r)}))}descendant(e,r=0){const[o,n]=this.children.find(r);return null==e.blotName&&e(o)||null!=e.blotName&&o instanceof e?[o,n]:o instanceof t?o.descendant(e,n):[null,-1]}descendants(e,r=0,o=Number.MAX_VALUE){let n=[],i=o;return this.children.forEachAt(r,o,((r,o,s)=>{(null==e.blotName&&e(r)||null!=e.blotName&&r instanceof e)&&n.push(r),r instanceof t&&(n=n.concat(r.descendants(e,o,i))),i-=s})),n}detach(){this.children.forEach((t=>{t.detach()})),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach((r=>{e||this.statics.allowedChildren.some((t=>r instanceof t))||(r.statics.scope===b.BLOCK_BLOT?(null!=r.next&&this.splitAfter(r),null!=r.prev&&this.splitAfter(r.prev),r.parent.unwrap(),e=!0):r instanceof t?r.unwrap():r.remove())}))}formatAt(t,e,r,o){this.children.forEachAt(t,e,((t,e,n)=>{t.formatAt(e,n,r,o)}))}insertAt(t,e,r){const[o,n]=this.children.find(t);if(o)o.insertAt(n,e,r);else{const t=null==r?this.scroll.create("text",e):this.scroll.create(e,r);this.appendChild(t)}}insertBefore(t,e){null!=t.parent&&t.parent.children.remove(t);let r=null;this.children.insertBefore(t,e||null),t.parent=this,null!=e&&(r=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==r)&&this.domNode.insertBefore(t.domNode,r),t.attach()}length(){return this.children.reduce(((t,e)=>t+e.length()),0)}moveChildren(t,e){this.children.forEach((r=>{t.insertBefore(r,e)}))}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,r=!1){const[o,n]=this.children.find(e,r),i=[[this,e]];return o instanceof t?i.concat(o.path(n,r)):(null!=o&&i.push([o,n]),i)}removeChild(t){this.children.remove(t)}replaceWith(e,r){const o="string"==typeof e?this.scroll.create(e,r):e;return o instanceof t&&this.moveChildren(o),super.replaceWith(o)}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const r=this.clone();return this.parent&&this.parent.insertBefore(r,this.next||void 0),this.children.forEachAt(t,this.length(),((t,o,n)=>{const i=t.split(o,e);null!=i&&r.appendChild(i)})),r}splitAfter(t){const e=this.clone();for(;null!=t.next;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const r=[],o=[];t.forEach((t=>{t.target===this.domNode&&"childList"===t.type&&(r.push(...t.addedNodes),o.push(...t.removedNodes))})),o.forEach((t=>{if(null!=t.parentNode&&"IFRAME"!==t.tagName&&document.body.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const e=this.scroll.find(t);null!=e&&(null==e.domNode.parentNode||e.domNode.parentNode===this.domNode)&&e.detach()})),r.filter((t=>t.parentNode===this.domNode&&t!==this.uiNode)).sort(((t,e)=>t===e?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1)).forEach((t=>{let e=null;null!=t.nextSibling&&(e=this.scroll.find(t.nextSibling));const r=k(t,this.scroll);(r.next!==e||null==r.next)&&(null!=r.parent&&r.parent.removeChild(this),this.insertBefore(r,e||void 0))})),this.enforceAllowedChildren()}};P.uiClass="";const I=P,z=class t extends I{static create(t){return super.create(t)}static formats(e,r){const o=r.query(t.blotName);if(null==o||e.tagName!==o.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new E(this.domNode)}format(e,r){if(e!==this.statics.blotName||r){const t=this.scroll.query(e,b.INLINE);if(null==t)return;t instanceof g?this.attributes.attribute(t,r):r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r)}else this.children.forEach((e=>{e instanceof t||(e=e.wrap(t.blotName,!0)),this.attributes.copy(e)})),this.unwrap()}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,r,o){null!=this.formats()[r]||this.scroll.query(r,b.ATTRIBUTE)?this.isolate(t,e).format(r,o):super.formatAt(t,e,r,o)}optimize(e){super.optimize(e);const r=this.formats();if(0===Object.keys(r).length)return this.unwrap();const o=this.next;o instanceof t&&o.prev===this&&function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}(r,o.formats())&&(o.moveChildren(this),o.remove())}replaceWith(t,e){const r=super.replaceWith(t,e);return this.attributes.copy(r),r}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}wrap(e,r){const o=super.wrap(e,r);return o instanceof t&&this.attributes.move(o),o}};z.allowedChildren=[z,B],z.blotName="inline",z.scope=b.INLINE_BLOT,z.tagName="SPAN";const U=z,q=class t extends I{static create(t){return super.create(t)}static formats(e,r){const o=r.query(t.blotName);if(null==o||e.tagName!==o.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new E(this.domNode)}format(e,r){const o=this.scroll.query(e,b.BLOCK);null!=o&&(o instanceof g?this.attributes.attribute(o,r):e!==this.statics.blotName||r?r&&(e!==this.statics.blotName||this.formats()[e]!==r)&&this.replaceWith(e,r):this.replaceWith(t.blotName))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return null!=e&&(t[this.statics.blotName]=e),t}formatAt(t,e,r,o){null!=this.scroll.query(r,b.BLOCK)?this.format(r,o):super.formatAt(t,e,r,o)}insertAt(t,e,r){if(null==r||null!=this.scroll.query(e,b.INLINE))super.insertAt(t,e,r);else{const o=this.split(t);if(null==o)throw new Error("Attempt to insertAt after block boundaries");{const t=this.scroll.create(e,r);o.parent.insertBefore(t,o)}}}replaceWith(t,e){const r=super.replaceWith(t,e);return this.attributes.copy(r),r}update(t,e){super.update(t,e),t.some((t=>t.target===this.domNode&&"attributes"===t.type))&&this.attributes.build()}};q.blotName="block",q.scope=b.BLOCK_BLOT,q.tagName="P",q.allowedChildren=[U,q,B];const M=q,R=class extends I{checkMerge(){return null!==this.next&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,r,o){super.formatAt(t,e,r,o),this.enforceAllowedChildren()}insertAt(t,e,r){super.insertAt(t,e,r),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};R.blotName="container",R.scope=b.BLOCK_BLOT;const D=R,W={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},F=class extends I{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver((t=>{this.update(t)})),this.observer.observe(this.domNode,W),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const r=this.registry.find(t,e);return r?r.scroll===this?r:e?this.find(r.scroll.domNode.parentNode,!0):null:null}query(t,e=b.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){null!=this.scroll&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),0===t&&e===this.length()?this.children.forEach((t=>{t.remove()})):super.deleteAt(t,e)}formatAt(t,e,r,o){this.update(),super.formatAt(t,e,r,o)}insertAt(t,e,r){this.update(),super.insertAt(t,e,r)}optimize(t=[],e={}){super.optimize(e);const r=e.mutationsMap||new WeakMap;let o=Array.from(this.observer.takeRecords());for(;o.length>0;)t.push(o.pop());const n=(t,e=!0)=>{null==t||t===this||null!=t.domNode.parentNode&&(r.has(t.domNode)||r.set(t.domNode,[]),e&&n(t.parent))},i=t=>{r.has(t.domNode)&&(t instanceof I&&t.children.forEach(i),r.delete(t.domNode),t.optimize(e))};let s=t;for(let e=0;s.length>0;e+=1){if(e>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(s.forEach((t=>{const e=this.find(t.target,!0);null!=e&&(e.domNode===t.target&&("childList"===t.type?(n(this.find(t.previousSibling,!1)),Array.from(t.addedNodes).forEach((t=>{const e=this.find(t,!1);n(e,!1),e instanceof I&&e.children.forEach((t=>{n(t,!1)}))}))):"attributes"===t.type&&n(e.prev)),n(e))})),this.children.forEach(i),s=Array.from(this.observer.takeRecords()),o=s.slice();o.length>0;)t.push(o.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const r=new WeakMap;t.map((t=>{const e=this.find(t.target,!0);return null==e?null:r.has(e.domNode)?(r.get(e.domNode).push(t),null):(r.set(e.domNode,[t]),e)})).forEach((t=>{null!=t&&t!==this&&r.has(t.domNode)&&t.update(r.get(t.domNode)||[],e)})),e.mutationsMap=r,r.has(this.domNode)&&super.update(r.get(this.domNode),e),this.optimize(t,e)}};F.blotName="scroll",F.defaultChild=M,F.allowedChildren=[M,D],F.scope=b.BLOCK_BLOT,F.tagName="DIV";const K=class t extends B{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,r){null==r?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,r)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(0===t)return this;if(t===this.length())return this.next}const r=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(r,this.next||void 0),this.text=this.statics.value(this.domNode),r}update(t,e){t.some((t=>"characterData"===t.type&&t.target===this.domNode))&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function V(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(V=function(){return!!t})()}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}function X(t,e){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X(t,e)}function Q(t,e,r){return(e=H(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}K.blotName="text",K.scope=b.INLINE_BLOT;var G=new A("float","float"),J=new A("margin","margin"),Z=new A("display","display");function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(et=function(){return!!t})()}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}function ot(t,e){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ot(t,e)}function nt(t,e,r){return(e=it(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function it(t){var e=function(t){if("object"!=tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tt(e)?e:e+""}function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function at(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ut(o.key),o)}}function lt(t,e,r){return e&&at(t.prototype,e),r&&at(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ct(t,e,r){return(e=ut(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ut(t){var e=function(t){if("object"!=st(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==st(e)?e:e+""}window.Quill.register(G,!0),window.Quill.register(J,!0),window.Quill.register(Z,!0);var ht={DisplaySize:v,Toolbar:function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return Q(t=function(t,e,r){return e=Y(e),function(t,e){if(e&&("object"==$(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,V()?Reflect.construct(e,r||[],Y(t).constructor):e.apply(t,r))}(this,e,[].concat(o)),"onCreate",(function(){t.toolbar=document.createElement("div"),Object.assign(t.toolbar.style,t.options.toolbarStyles),t.overlay.appendChild(t.toolbar),t._defineAlignments(),t._addToolbarButtons()})),Q(t,"onDestroy",(function(){})),Q(t,"onUpdate",(function(){})),Q(t,"_defineAlignments",(function(){t.alignments=[{icon:'<svg viewbox="0 0 18 18">\n  <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>\n  <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>\n  <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>\n</svg>',apply:function(){Z.add(t.img,"inline"),G.add(t.img,"left"),J.add(t.img,"0 1em 1em 0")},isApplied:function(){return"left"==G.value(t.img)}},{icon:'<svg viewbox="0 0 18 18">\n  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n  <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>\n  <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>\n</svg>',apply:function(){Z.add(t.img,"block"),G.remove(t.img),J.add(t.img,"auto")},isApplied:function(){return"auto"==J.value(t.img)}},{icon:'<svg viewbox="0 0 18 18">\n  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n  <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>\n  <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>\n</svg>',apply:function(){Z.add(t.img,"inline"),G.add(t.img,"right"),J.add(t.img,"0 0 1em 1em")},isApplied:function(){return"right"==G.value(t.img)}}]})),Q(t,"_addToolbarButtons",(function(){var e=[];t.alignments.forEach((function(r,o){var n=document.createElement("span");e.push(n),n.innerHTML=r.icon,n.addEventListener("click",(function(){e.forEach((function(t){return t.style.filter=""})),r.isApplied()?(G.remove(t.img),J.remove(t.img),Z.remove(t.img)):(t._selectButton(n),r.apply()),t.requestUpdate()})),Object.assign(n.style,t.options.toolbarButtonStyles),o>0&&(n.style.borderLeftWidth="0"),Object.assign(n.children[0].style,t.options.toolbarButtonSvgStyles),r.isApplied()&&t._selectButton(n),t.toolbar.appendChild(n)}))})),Q(t,"_selectButton",(function(t){t.style.filter="invert(20%)"})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(u),Resize:function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return nt(t=function(t,e,r){return e=rt(e),function(t,e){if(e&&("object"==tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,et()?Reflect.construct(e,r||[],rt(t).constructor):e.apply(t,r))}(this,e,[].concat(o)),"onCreate",(function(){t.boxes=[],t.addBox("nwse-resize"),t.addBox("nesw-resize"),t.addBox("nwse-resize"),t.addBox("nesw-resize"),t.positionBoxes()})),nt(t,"onDestroy",(function(){t.setCursor("")})),nt(t,"positionBoxes",(function(){var e="".concat(-parseFloat(t.options.handleStyles.width)/2,"px"),r="".concat(-parseFloat(t.options.handleStyles.height)/2,"px");[{left:e,top:r},{right:e,top:r},{right:e,bottom:r},{left:e,bottom:r}].forEach((function(e,r){Object.assign(t.boxes[r].style,e)}))})),nt(t,"addBox",(function(e){var r=document.createElement("div");Object.assign(r.style,t.options.handleStyles),r.style.cursor=e,r.style.width="".concat(t.options.handleStyles.width,"px"),r.style.height="".concat(t.options.handleStyles.height,"px"),r.addEventListener("mousedown",t.handleMousedown,!1),t.overlay.appendChild(r),t.boxes.push(r)})),nt(t,"handleMousedown",(function(e){t.dragBox=e.target,t.dragStartX=e.clientX,t.preDragWidth=t.img.width||t.img.naturalWidth,t.setCursor(t.dragBox.style.cursor),document.addEventListener("mousemove",t.handleDrag,!1),document.addEventListener("mouseup",t.handleMouseup,!1)})),nt(t,"handleMouseup",(function(){t.setCursor(""),document.removeEventListener("mousemove",t.handleDrag),document.removeEventListener("mouseup",t.handleMouseup)})),nt(t,"handleDrag",(function(e){if(t.img){var r=e.clientX-t.dragStartX;t.dragBox===t.boxes[0]||t.dragBox===t.boxes[3]?t.img.width=Math.round(t.preDragWidth-r):t.img.width=Math.round(t.preDragWidth+r),t.requestUpdate()}})),nt(t,"setCursor",(function(e){[document.body,t.img].forEach((function(t){t.style.cursor=e}))})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ot(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(u)},dt=lt((function t(r){var o=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,"initializeModules",(function(){o.removeModules(),o.modules=o.moduleClasses.map((function(t){return new(ht[t]||t)(o)})),o.modules.forEach((function(t){t.onCreate()})),o.onUpdate()})),ct(this,"onUpdate",(function(){o.repositionElements(),o.modules.forEach((function(t){t.onUpdate()}))})),ct(this,"removeModules",(function(){o.modules.forEach((function(t){t.onDestroy()})),o.modules=[]})),ct(this,"handleClick",(function(t){if(t.target&&t.target.tagName&&"IMG"===t.target.tagName.toUpperCase()){if(o.img===t.target)return;o.img&&o.hide(),o.show(t.target)}else o.img&&o.hide()})),ct(this,"show",(function(t){o.img=t,o.showOverlay(),o.initializeModules()})),ct(this,"showOverlay",(function(){o.overlay&&o.hideOverlay(),o.quill.setSelection(null),o.setUserSelect("none"),document.addEventListener("keyup",o.checkImage,!0),o.quill.root.addEventListener("input",o.checkImage,!0),o.overlay=document.createElement("div"),Object.assign(o.overlay.style,o.options.overlayStyles),o.quill.root.parentNode.appendChild(o.overlay),o.repositionElements()})),ct(this,"hideOverlay",(function(){o.overlay&&(o.quill.root.parentNode.removeChild(o.overlay),o.overlay=void 0,document.removeEventListener("keyup",o.checkImage),o.quill.root.removeEventListener("input",o.checkImage),o.setUserSelect(""))})),ct(this,"repositionElements",(function(){if(o.overlay&&o.img){var t=o.quill.root.parentNode,e=o.img.getBoundingClientRect(),r=t.getBoundingClientRect();Object.assign(o.overlay.style,{left:"".concat(e.left-r.left-1+t.scrollLeft,"px"),top:"".concat(e.top-r.top+t.scrollTop,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")})}})),ct(this,"hide",(function(){o.hideOverlay(),o.removeModules(),o.img=void 0})),ct(this,"setUserSelect",(function(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach((function(e){o.quill.root.style[e]=t,document.documentElement.style[e]=t}))})),ct(this,"checkImage",(function(t){o.img&&(46!=t.keyCode&&8!=t.keyCode||window.Quill.find(o.img).deleteAt(0),o.hide())})),this.quill=r;var s=!1;i.modules&&(s=i.modules.slice()),this.options=e()({},i,n),!1!==s&&(this.options.modules=s),document.execCommand("enableObjectResizing",!1,"false"),this.quill.root.addEventListener("click",this.handleClick,!1),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.moduleClasses=this.options.modules,this.modules=[]}));window.Quill&&window.Quill.register("modules/imageResize",dt)})(),o})()));